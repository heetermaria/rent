---
title: "summaryStats"
author: "Maria Heeter"
date: "3/30/2022"
output: html_document
---

# set up 
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(DT)
library(sjPlot)
library(skimr)
library(flextable)
```

# load in data 
```{r}
# imports ACS dataframe 
df <- read.csv("thesisDF.csv")
```

# makes into panel 

```{r}
df_panel <- panel_data(df, id = fips, wave = year)
df_panel

summary(df_panel)

# my vars select 
myvars <- c("mean_mean_nom_housing_value", "mean_mean_nom_contract_rent", "rent_price_ratio_national") # see which to incl 
df_panel_sum <- df_panel[myvars]

# renames vars 
df_panel_sum <- rename(df_panel_sum, avgNoHV = mean_mean_nom_housing_value)
df_panel_sum <- rename(df_panel_sum, avgCoRt = mean_mean_nom_contract_rent)
df_panel_sum <- rename(df_panel_sum, avgRPR = rent_price_ratio_national)

# gens sum stast 
sumStats <- summary(df_panel_sum, avgNoHV, avgCoRt, avgRPR, year)
datatable(sumStats)

# cuts off decimal 
sumStats$numeric.mean <- format(round(sumStats$numeric.mean, 2), nsmall=2)
sumStats$numeric.sd <- format(round(sumStats$numeric.sd, 2), nsmall=2)
sumStats$numeric.p0 <- format(round(sumStats$numeric.p0, 2), nsmall=2)
sumStats$numeric.p50 <- format(round(sumStats$numeric.p50,2), nsmall=2)
sumStats$numeric.p100 <- format(round(sumStats$numeric.p100, 2), nsmall=2)
sumStats$year <- as.numeric(gsub(",", "", sumStats$year))

sumStats <- sumStats %>% dplyr::select(skim_variable, year, numeric.mean, numeric.sd, numeric.p0, numeric.p50, numeric.p100, numeric.hist)

set_flextable_defaults(font.family="Times New Roman")
flexTableStats <- flextable(sumStats)
flexTableStats <- theme_vanilla(flexTableStats)
flexTableStats


save_as_docx("my table 1" = flexTableStats, path = "sumStatsTable.docx")
print(flexTableStats, preview="docx")


```